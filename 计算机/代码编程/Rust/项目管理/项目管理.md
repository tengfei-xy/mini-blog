# é¡¹ç›®ç®¡ç†

## ç›®å½•

-   [æ¦‚å¿µ](#æ¦‚å¿µ)
-   [é¡¹ç›®ä¾èµ–](#é¡¹ç›®ä¾èµ–)
-   [ç»“æ„](#ç»“æ„)
-   [ç”Ÿå‘½å‘¨æœŸ](#ç”Ÿå‘½å‘¨æœŸ)

# æ¦‚å¿µ

-   é¡¹ç›®(Package)

    åŒ…å«ï¼šç‹¬ç«‹çš„`Cargon.toml`æ–‡ä»¶ï¼Œå› ä¸ºåŠŸèƒ½æ€§è¢«ç»„ç»‡åœ¨ä¸€èµ·çš„ä¸€ä¸ªæˆ–å¤šä¸ªåŒ…ã€‚

    æ³¨æ„ï¼šä¸€ä¸ª `Package` åªèƒ½åŒ…å«**ä¸€ä¸ª**åº“(library)ç±»å‹çš„åŒ…ï¼Œä½†æ˜¯å¯ä»¥åŒ…å«**å¤šä¸ª**äºŒè¿›åˆ¶å¯æ‰§è¡Œç±»å‹çš„åŒ…ã€‚

    ä¸€ä¸ª `Cargo` æä¾›çš„ `feature`ï¼Œå¯ä»¥ç”¨æ¥æ„å»ºã€æµ‹è¯•å’Œåˆ†äº«åŒ…
    -   åº“ç±»å‹çš„é¡¹ç›®
        ```rust
        $ cargo new my-lib --lib
             Created library `my-lib` package
        $ ls my-lib
        Cargo.toml
        src
        $ ls my-lib/src
        lib.rs
        ```
-   åŒ…

    å®šä¹‰ï¼šåŒ…(Crate)æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯ç¼–è¯‘å•å…ƒ

    ä½œç”¨ï¼šä¸€ä¸ªåŒ…ä¼šå°†ç›¸å…³è”çš„åŠŸèƒ½æ‰“åŒ…åœ¨ä¸€èµ·

    æ„ä¹‰ï¼šä½¿å¾—è¯¥åŠŸèƒ½å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨å¤šä¸ªé¡¹ç›®ä¸­åˆ†äº«

    ç»“æœï¼šç¼–è¯‘åä¼šç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…ä¸€ä¸ªåº“

    æ³¨æ„ï¼šåŒä¸€ä¸ªåŒ…ä¸­ä¸èƒ½æœ‰åŒåçš„ç±»å‹ï¼Œä½†æ˜¯åœ¨ä¸åŒåŒ…ä¸­å°±å¯ä»¥
-   æ¨¡å—

    å®šä¹‰ï¼šæ¨¡å—(Module)å¯ä»¥ä¸€ä¸ªæ–‡ä»¶å¤šä¸ªæ¨¡å—ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥è¢«è®¤ä¸ºæ˜¯çœŸå®é¡¹ç›®ä¸­çš„ä»£ç ç»„ç»‡å•å…ƒ
    > ğŸ“Œ1. ä½¿ç”¨ mod å…³é”®å­—æ¥åˆ›å»ºæ–°æ¨¡å—ï¼Œåé¢ç´§è·Ÿç€æ¨¡å—åç§°
    > 2\. æ¨¡å—å¯ä»¥åµŒå¥—ï¼Œè¿™é‡ŒåµŒå¥—çš„åŸå› æ˜¯æ‹›å¾…å®¢äººå’ŒæœåŠ¡éƒ½å‘ç”Ÿåœ¨å‰å…ï¼Œå› æ­¤æˆ‘ä»¬çš„ä»£ç æ¨¡æ‹Ÿäº†çœŸå®åœºæ™¯
    > 3\. æ¨¡å—ä¸­å¯ä»¥å®šä¹‰å„ç§ Rust ç±»å‹ï¼Œä¾‹å¦‚å‡½æ•°ã€ç»“æ„ä½“ã€æšä¸¾ã€ç‰¹å¾ç­‰
    > 4\. æ‰€æœ‰æ¨¡å—å‡å®šä¹‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­
    -   åˆ›å»ºåµŒå¥—æ¨¡å—

        åˆ›å»ºçš„æ˜¯ä¸€ä¸ªåº“ç±»å‹çš„ `Package`
        ```bash
         cargo new --lib restauran
        ```
        å†™æ¨¡å—åˆ°`src/lib.rc`ä¸­
        ```rust
        // é¤å…å‰å…ï¼Œç”¨äºåƒé¥­
        mod front_of_house {
            mod hosting {
                fn add_to_waitlist() {}
                fn seat_at_table() {}
            }
            mod serving {
                fn take_order() {}
                fn serve_order() {}
                fn take_payment() {}
            }
        }
        ```
    -   å¼•ç”¨æ¨¡å—

        æ¨¡å—æ ‘
        ```rust
        crate
         â””â”€â”€ front_of_house
             â”œâ”€â”€ hosting
             â”‚   â”œâ”€â”€ add_to_waitlist
             â”‚   â””â”€â”€ seat_at_table
             â””â”€â”€ serving
                 â”œâ”€â”€ take_order
                 â”œâ”€â”€ serve_order
                 â””â”€â”€ take_payment
        ```
        -   ç»å¯¹è·¯å¾„

            ä»åŒ…æ ¹å¼€å§‹ï¼Œè·¯å¾„åä»¥åŒ…åæˆ–è€… `crate` ä½œä¸ºå¼€å¤´
            ```rust
            mod front_of_house {
                mod hosting {
                    fn add_to_waitlist() {}
                }
            }

            pub fn eat_at_restaurant() {
                // ç»å¯¹è·¯å¾„
                crate::front_of_house::hosting::add_to_waitlist();

            }
            ```
        -   ç›¸å¯¹è·¯å¾„

            ä»å½“å‰æ¨¡å—å¼€å§‹ï¼Œä»¥ `self`ï¼Œ`super` æˆ–å½“å‰æ¨¡å—çš„æ ‡è¯†ç¬¦ä½œä¸ºå¼€å¤´
            ```rust
            mod front_of_house {
                mod hosting {
                    fn add_to_waitlist() {}
                }
            }

            pub fn eat_at_restaurant() {
                // ç›¸å¯¹è·¯å¾„
                front_of_house::hosting::add_to_waitlist();
            }
            ```
        -   å¼•ç”¨åˆ«å
            ```rust
            use std::fmt::Result;
            use std::io::Result as IoResult;

            fn function1() -> Result {
                // --snip--
            }

            fn function2() -> IoResult<()> {
                // --snip--
            }
            ```

# é¡¹ç›®ä¾èµ–

ç¬¬ä¸‰æ–¹åŒ…ï¼š[Rustç¤¾åŒº](https://crates.io/ "Rustç¤¾åŒº")ã€[lib.rc](https://lib.rs/ "lib.rc")

-   ä¾èµ–å†™å…¥æ–¹å¼

    åœ¨ `Cargo.toml` ä¸­ï¼Œä¸»è¦é€šè¿‡å„ç§ä¾èµ–æ®µè½æ¥æè¿°è¯¥é¡¹ç›®çš„å„ç§ä¾èµ–é¡¹ï¼š
    -   åŸºäº Rust å®˜æ–¹ä»“åº“ `crates.io`ï¼Œé€šè¿‡ç‰ˆæœ¬è¯´æ˜æ¥æè¿°
    -   åŸºäºé¡¹ç›®æºä»£ç çš„ git ä»“åº“åœ°å€ï¼Œé€šè¿‡ URL æ¥æè¿°
    -   åŸºäºæœ¬åœ°é¡¹ç›®çš„ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„ï¼Œé€šè¿‡ç±» Unix æ¨¡å¼çš„è·¯å¾„æ¥æè¿°
        è¿™ä¸‰ç§å½¢å¼å…·ä½“å†™æ³•å¦‚ä¸‹ï¼š
    ```rust
    [dependencies]
    rand = "0.3"
    hammer = { version = "0.5.0"}
    color = { git = "https://github.com/bjz/color-rs" }
    geometry = { path = "crates/geometry" }
    ```
-   ä»£ç ç®€åŒ–å¼•å…¥
    -   éƒ¨åˆ†å¼•å…¥
        ```rust
        use std::collections::HashMap;
        use std::collections::BTreeMap;
        use std::collections::HashSet;

        use std::cmp::Ordering;
        use std::io;

        //ç®€åŒ–ä¸º
        use std::collections::{HashMap,BTreeMap,HashSet};
        use std::{cmp::Ordering, io};

        ```
    -   æ‰€æœ‰å¼•å…¥
        ```rust
        use std::collections::*;
        ```

[å‚è€ƒå—é™çš„å¯è§æ€§](https://course.rs/basic/crate-module/use.html#å—é™çš„å¯è§æ€§ "å‚è€ƒå—é™çš„å¯è§æ€§")

# ç»“æ„

è¿™ç§ç›®å½•ç»“æ„åŸºæœ¬ä¸Šæ˜¯ Rust çš„æ ‡å‡†ç›®å½•ç»“æ„ï¼Œä¸€ä¸ªçœŸå®é¡¹ç›®ä¸­å…¸å‹çš„ `Package`ï¼Œä¼šåŒ…å«å¤šä¸ªäºŒè¿›åˆ¶åŒ…ï¼Œè¿™äº›åŒ…æ–‡ä»¶è¢«æ”¾åœ¨ `src/bin` ç›®å½•ä¸‹ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„äºŒè¿›åˆ¶åŒ…ï¼ŒåŒæ—¶ä¹Ÿä¼šåŒ…å«ä¸€ä¸ªåº“åŒ…ï¼Œè¯¥åŒ…åªèƒ½å­˜åœ¨ä¸€ä¸ª `src/lib.rs`ã€‚åœ¨ `GitHub` çš„å¤§å¤šæ•°é¡¹ç›®ä¸Šï¼Œä½ éƒ½å°†çœ‹åˆ°å®ƒçš„èº«å½±ã€‚

```rust
.
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ main.rs
â”‚   â”œâ”€â”€ lib.rs
â”‚   â””â”€â”€ bin
â”‚       â””â”€â”€ main1.rs
â”‚       â””â”€â”€ main2.rs
â”œâ”€â”€ tests
â”‚   â””â”€â”€ some_integration_tests.rs
â”œâ”€â”€ benches
â”‚   â””â”€â”€ simple_bench.rs
â””â”€â”€ examples
    â””â”€â”€ simple_example.rs
```

-   é¡¹ç›®æ–‡ä»¶è¯´æ˜

    `Cargo.toml` æ˜¯ `cargo` ç‰¹æœ‰çš„**é¡¹ç›®æ•°æ®æè¿°æ–‡ä»¶**ã€‚å®ƒå­˜å‚¨äº†é¡¹ç›®çš„æ‰€æœ‰å…ƒé…ç½®ä¿¡æ¯ï¼Œå¦‚æœ Rust å¼€å‘è€…å¸Œæœ› Rust é¡¹ç›®èƒ½å¤ŸæŒ‰ç…§æœŸæœ›çš„æ–¹å¼è¿›è¡Œæ„å»ºã€æµ‹è¯•å’Œè¿è¡Œï¼Œé‚£ä¹ˆï¼Œå¿…é¡»æŒ‰ç…§åˆç†çš„æ–¹å¼æ„å»º `Cargo.toml`ã€‚

    `Cargo.lock` æ˜¯ `cargo` å·¥å…·æ ¹æ®åŒä¸€é¡¹ç›®çš„ `toml` æ–‡ä»¶ç”Ÿæˆçš„**é¡¹ç›®ä¾èµ–è¯¦ç»†æ¸…å•**ï¼Œå› æ­¤æˆ‘ä»¬ä¸€èˆ¬ä¸ç”¨ä¿®æ”¹å®ƒï¼Œåªéœ€è¦å¯¹ç€ `Cargo.toml` æ–‡ä»¶æ’¸å°±è¡Œäº†ã€‚

    `src/lib.rs`ï¼šå”¯ä¸€åº“åŒ…

    `src/main.rs`ï¼šé»˜è®¤äºŒè¿›åˆ¶åŒ…ï¼Œç¼–è¯‘åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸ `Package` åŒå

    `src/bin/main1.rs` å’Œ `src/bin/main2.rs`ï¼Œå…¶ä½™äºŒè¿›åˆ¶åŒ…ï¼Œå®ƒä»¬ä¼šåˆ†åˆ«ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åŒåçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶

    `tests/` ï¼šé›†æˆæµ‹è¯•æ–‡ä»¶

    `benches/` ï¼šåŸºå‡†æ€§èƒ½æµ‹è¯•&#x20;

    `example/` é¡¹ç›®ç¤ºä¾‹

# ç”Ÿå‘½å‘¨æœŸ

-   åˆ›å»ºé¡¹ç›®
    ```bash
    cargo new hello_word
    ```
-   è¿è¡Œé¡¹ç›®
    -   è‡ªåŠ¨ç¼–è¯‘ä¸è¿è¡Œ
        ```rust
        $ cargo run
           Compiling world_hello v0.1.0 (/Users/sunfei/development/rust/world_hello)
            Finished dev [unoptimized + debuginfo] target(s) in 0.43s
             Running `target/debug/world_hello`
        Hello, world!
        ```
    -   æ‰‹åŠ¨ç¼–è¯‘ä¸æ‰‹åŠ¨è¿è¡Œ

        ç¼–è¯‘
        ```bash
        $ cargo build
            Finished dev [unoptimized + debuginfo] target(s) in 0.00s
        ```
        è¿è¡Œ
        ```bash
        $ ./target/debug/world_hello
        Hello, world!
        ```
