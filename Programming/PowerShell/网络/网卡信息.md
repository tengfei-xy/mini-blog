获取网卡索引

```powershell
Get-NetAdapter | fl Name,Interfaceindex
```

根据匹配的IP地址获取索引

```powershell
(Get-NetIPAddress | Where-Object {$_.IPAddress -match "^192"}).InterfaceIndex
```

根据网卡索引获取IP、DNS

```powershell
Get-NetIPConfiguration -Interfaceindex 23
```

根据IP获取MAC地址

```powershell
$ip="192.168.0.20"
(Get-NetAdapter -InterfaceIndex (Get-NetIPAddress -IPAddress $ip).InterfaceIndex ).MacAddress
```



# DNS

获取DNS

```
(Get-NetAdapter -ifindex 23 | Get-DnsClientServerAddress -AddressFamily IPV4 ).ServerAddresses
```

根据IP地址获取DNS

```powershell
(Get-NetAdapter -ifindex ((Get-NetIPAddress -IPAddress 192.168.31.195).InterfaceIndex) | Get-DnsClientServerAddress -AddressFamily IPV4 ).ServerAddresses
```

设置静态DNS，将ifindex为23的网卡的主要DNS设置为192.168.0.20，次要DNS设置为114.114.114.114

```powershell
Get-NetAdapter -ifindex 23 | Set-DNSClientServerAddress -ServerAddresses 192.168.0.20,114.114.114.114
```

设置动态DNS

```powershell
Get-NetAdapter -ifindex 23 | Set-NetIPInterface -Dhcp Enabled
```



# 管理

重启网卡

```powershell
Restart-NetAdapter -InterfaceAlias Ethernet0
```